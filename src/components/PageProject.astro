---
import { getCurrentLang, useTranslations } from '@/i18n/utils';
import Layout from '@/layouts/Layout.astro';
import type { CollectionEntry } from 'astro:content';
import { getRelativeLocaleUrl } from 'astro:i18n';

interface Props {
  project: CollectionEntry<'projects'>;
}

const { project } = Astro.props as Props;
const lang = getCurrentLang(Astro.currentLocale);
const t = useTranslations(lang);

const { slug } = project;
const { title, description, tags, screenshot } = project.data;
const img = screenshot ? screenshot : `/img/projects/${slug}.webp`;
const { Content } = await project.render();
---

<Layout title={title} lang={lang}>
  <section class="mx-auto max-w-3xl px-6 py-12">
    <a
      href={getRelativeLocaleUrl(lang)}
      class="mb-6 inline-flex transform cursor-pointer items-center rounded-lg bg-indigo-600 px-4 py-2 font-medium text-white shadow-md transition-transform hover:-translate-y-0.5 hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:outline-none"
    >
      ‚Üê {t('action.back')}
    </a>

    {
      title && (
        <h1
          transition:name={`title-${slug}`}
          class="prose prose-xl md:prose-2xl dark:prose-invert prose-headings:underline mb-4 text-4xl font-extrabold tracking-tight md:text-5xl"
        >
          {title}
        </h1>
      )
    }

    <img
      transition:name={`img-${slug}`}
      src={img}
      alt={`Screenshot of ${title} ${img}`}
      class="mb-6 h-auto w-full rounded-xl object-cover shadow-lg"
    />

    {
      description && (
        <p
          transition:name={`description-${slug}`}
          class="prose prose-base md:prose-lg lg:prose-xl dark:prose-invert prose-p:text-gray-700 dark:prose-p:text-gray-300 mb-6"
        >
          {description}
        </p>
      )
    }

    {
      tags && (
        <ul class="mb-8 flex flex-wrap gap-2">
          {tags.map((tag) => (
            <li class="rounded-full bg-indigo-100 px-3 py-1 text-sm font-medium text-indigo-800">
              {tag}
            </li>
          ))}
        </ul>
      )
    }

    <article
      class="prose prose-lg md:prose-xl dark:prose-invert prose-img:rounded-xl prose-a:text-indigo-600 prose-a:hover:text-indigo-500"
    >
      <Content />
    </article>
  </section>
</Layout>
